/*#BY JESUS EDUARDO MURRIETA ROSAS
#Reposiotrio en github del proyecto 
#github     https://github.com/soru13/GestionDeProyectos*/
// Generated by CoffeeScript 1.4.0
var ajax=(function($){
  var _accion="";
  var _id_Proyecto="";
  var _id_Actividad="";
  var _id_Avance="";
  var _valor="";
  var _actividad="";
  var _id_Usuario="";
  function _GetDataProyecto(){
    $.ajax({
          url: 'GetDataProyectoJson/'+_id_Proyecto,
          type: 'POST',
          success: function(data) {
            $("#id_Proyecto").val(data[0].fields.Proyecto);
            $("#id_Usuario").val(data[0].fields.Usuario);
            $("#id_Estatus").val(data[0].fields.Estatus);
          },
          processData: false,
          contentType: false
      });
  }
  function _GetDataActividad(){
    $.ajax({
          url: '/GetDataActividadJson/'+_id_Actividad,
          type: 'POST',
          success: function(data) {
            $("#id_Actividad").val(data[0].fields.Actividad);
            $("#id_Desde").val(data[0].fields.Desde);
            $("#id_Hasta").val(data[0].fields.Hasta);
            $("#id_Estatus").val(data[0].fields.Estatus);
            $("#id_Proyecto").val(data[0].fields.Proyecto);
            $("#id_Usuario").val(data[0].fields.Usuario);
            $("#id_FechaSolicitud").val(data[0].fields.FechaSolicitud);
            $("#id_Solicitud").val(data[0].fields.Solicitud);
            $(".wysihtml5-sandbox").html(data[0].fields.Observaciones);
            alert(data[0].fields.Observaciones);
          },
          processData: false,
          contentType: false
      });
  }

  function started(){
    
    

    $("#leido").on("click", function(){
      $("#myModal").modal("show");
      $.ajax({
          async:true,
              url: '/InBox/',
              type: 'POST',
              success: function(response) {
                if (response.exito) {
                  $("#leido").html('<img src="http://192.168.1.10/static/base/img/inbox-5-24.ico"/>0 Notificaciones');
                  console.log("exito");
                }
              },
        });
    });
    $( "#from" ).datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      dateFormat: 'yy-mm-dd',
      onClose: function( selectedDate ) {
        $( "#to" ).datepicker( "option", "minDate", selectedDate );
        $("#to").attr({'required':'true'});
      }
    });
    $( "#to" ).datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      dateFormat: 'yy-mm-dd',
      onClose: function( selectedDate ) {
        $( "#from" ).datepicker( "option", "maxDate", selectedDate );
        $("#from").attr({'required':'true'});
      }
    });
    $("time.timeago").timeago();
    _accion = $('#formulario').find('input[type=submit]').val();
    $("input").keypress(function (e) {
       var charCode
            if (navigator.appName == "Netscape"){
            charCode = e.which
            }
            else{
            charCode = e.keyCode
            }   
            if ( charCode > 32 && charCode < 48 || charCode > 57 && charCode < 64 || charCode > 90 && charCode < 97 || charCode > 122 && charCode < 126) {
                    
            return false
            }
            else{
            return true}
    });

     $("#id_Points").keypress(function (e) {
       var charCode
            if (navigator.appName == "Netscape"){
            charCode = e.which
            }
            else{
            charCode = e.keyCode}   
            if ( charCode > 32 && charCode < 255 ) {
                    
            return false
            }
            else{
            return true}
    });
    if (_accion=="Agregar") {
      $("#allformulario").show();
      _AgregarProyectoAjax();
    }
    if (_accion=="Terminar") {
      $("#allformulario").attr({'title':'Editar Proyecto'});
    }
    if (_accion=="AgregarAct") {
      $("#allformulario").show();
      $('#id_Observaciones').wysihtml5({
        "font-styles": true, //Font styling, e.g. h1, h2, etc. Default true
        "emphasis": true, //Italics, bold, etc. Default true
        "lists": true, //(Un)ordered lists, e.g. Bullets, Numbers. Default true
        "html": false, //Button which allows you to edit the generated HTML. Default false
        "link": true, //Button to insert a link. Default true
        "image": true, //Button to insert an image. Default true,
        "color": false //Button to change color of font  
      });
      _AgregarActividadAjax();
    }
    if (_accion=="TerminarAct") {
      $('#id_Observaciones').wysihtml5({
        "font-styles": true, //Font styling, e.g. h1, h2, etc. Default true
        "emphasis": true, //Italics, bold, etc. Default true
        "lists": true, //(Un)ordered lists, e.g. Bullets, Numbers. Default true
        "html": false, //Button which allows you to edit the generated HTML. Default false
        "link": true, //Button to insert a link. Default true
        "image": true, //Button to insert an image. Default true,
        "color": false //Button to change color of font  
      });
      $("#allformulario").attr({'title':'Editar Actividad'});
      id_Actividad = location.href.substr(location.href.lastIndexOf('/')+1);
      
      EditarAct(id_Actividad);
    }
    if (_accion=="AgregarAvance") {
      $("#exito").hide();

      _valor = $("#porcentaje").text();
      if (_valor==100) {
          $("#AgregarAvance").hide();
          $("#allformulario").hide();
      }else{
       $( "#id_Points" ).spinner({ max: 100 });
      //valor
      $( "#id_Points" ).spinner( "value", _valor );
      // getter
      var max = $( "#id_Points" ).spinner( "option", "max" );
      // setter
      $( "#id_Points" ).spinner( "option", "min", _valor );

      $("#AgregarAvance").bind('click',function(e){
        e.preventDefault();

           _id_Avance = location.href.substr(location.href.lastIndexOf('/')+1);

          $("#allformulario").show();
          $("#AgregarAvance").hide();
          actividad = $(this).attr("name");//take nombre de la actividad
          $('#formulario').bind('submit', function(e) {
                e.preventDefault();

                var url = '/AgregarAvanceAjax/';
                var fd = new FormData($('#formulario').get(0));
                fd.append("Actividad", actividad );
                fd.append("Estatus", 'actividad' );
                $.ajax({
                  url: url,
                  data: fd,
                  type: 'POST',
                  beforeSend: function(){
                       console.log("se enviaron datos");
                  },
                  success: function(data) {
                    if (data.exito) {
                        _marcar();
                        $("textarea").val('');
                        _valor=$("#id_Points").val();
                         $( "#id_Points" ).spinner({ max: 100 });
                        //valor
                        $( "#id_Points" ).spinner( "value", _valor );
                        // getter
                        var max = $( "#id_Points" ).spinner( "option", "max" );
                        // setter
                        $( "#id_Points" ).spinner( "option", "min", _valor );
                        if (_valor==100) {
                          
                          $("#allformulario").hide();
                        }
                    } else {
                      $("#resultados").html('');
                      if (data.errores.Avance) {
                          $('<span class="alert alert-error"><b>Avance </b>' + data.errores.Avance + '</span>').appendTo('#resultados');
                        }
                        if (data.errores.Points) {
                          $('<span class="alert alert-error"><b>Points </b>' + data.errores.Points + '</span>').appendTo('#resultados');
                        }
                        if (data.errores.Actividad) {
                          $('<span class="alert alert-error"><b>Actividad </b>' + data.errores.Actividad + '</span>').appendTo('#resultados');
                        }
                        if (data.errores.Estatus) {
                          $('<span class="alert alert-error"><b>Estatus </b>' + data.errores.Estatus + '</span>').appendTo('#resultados');
                        }
                    }
                  },
                  processData: false,
                  contentType: false
                });
          });
      });
      }
    }
  }
  function _AgregarProyectoAjax(){
    $('#exito').attr({'title':'Proyectos','href':'/ControlActividades'});
    $('#formulario').bind('submit', function(e) {
            e.preventDefault();
            var url ='/AgregarProyectoAjax/';
            var fd = new FormData($('#formulario').get(0));
            fd.append("Estatus", 'on' );
            $.ajax({
                url: url,
                data: fd,
                type: 'POST',
               beforeSend: function(){
                     console.log(fd);
                },
                success: function(data) {
                  if (data.exito) {
                      $("#formulario").get(0).reset();
                      $("#resultados").html("<span class='alert alert-success'>Creado Exitosamente</span>");
                      setTimeout(function(){ $("#resultados").html('')}, 2000);
                  } else {
                    $("#resultados").html('');
                    if (data.errores.Proyecto) {
                      $('<span class="alert alert-error"><b>Proyecto </b>' + data.errores.Proyecto + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Usuario) {
                      $('<span class="alert alert-error"><b>Usuario </b>' + data.errores.Usuario + '</span>').appendTo('#resultados');
                    }
                  }
                },
                processData: false,
                contentType: false
            });
        });
  }
  function EditarProyecto(id){
      console.log(id);
      _id_Proyecto = id;
      $("#allformulario").dialog({
                modal: true,
                width: 910,
                minWidth: 300,
                maxWidth: 300,
                height:600,
                show: "fold",
                resizable: false,
      });
      $("#exito").hide();
      _GetDataProyecto();
      $('#formulario').submit(_EditarProyAjax);
  }
  function _EditarProyAjax(e){
    e.preventDefault();
          var url = '/EditarProyectoAjax/'+_id_Proyecto;
          var fd = $(this).serialize();
          $.ajax({
                url: url,
                data: fd,
                type: 'POST',
                beforeSend: function(){
                  console.log(fd);   
                },
                success: function(data) {
                  if (data.exito) {
                      $("#allformulario").dialog( "close" );
                      $("#resultados").html('');
                      _marcar();
                      //$("#resultados").html("<span class='alert alert-success'>Creado Exitosamente</span>");
                  } else {
                    $("#resultados").html('');
                    if (data.errores.Proyecto) {
                      $('<span class="alert alert-error"><b>Proyecto </b>' + data.errores.Proyecto + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Usuario) {
                      $('<span class="alert alert-error"><b>Usuario </b>' + data.errores.Usuario + '</span>').appendTo('#resultados');
                    }
                  }
                },  
          });
  }

  function _marcar(){
    if (_accion=="Terminar") {
       $.ajax({
          async:true,
              url: 'GetDataProyectoJson/'+_id_Proyecto,
              type: 'POST',
              success: function(response) {
                status="";
                if (response[0].fields.Estatus) {
                  status='<img src="http://192.168.1.10/static/base/img/check-mark-3-24.ico">';
                  console.log(status);
                }else{
                  status='<img src="http://192.168.1.10/static/base/img/x-mark-24.ico">';
                  console.log(status);
                }
                $("#"+_id_Proyecto).html('<td>'+response[0].fields.Proyecto+'</td><td>'+response[0].fields.Usuario+'</td><td>'+response[0].fields.Fecha+'</td><td>'+status+'</td><td><a href="/Actividades/'+response[0].pk+'" title="Mostrar Actividades" ><img src="http://192.168.1.10/static/base/img/fullscreen-8-32.ico" /></a></td><td><a href="#" onclick="javascript:ajax.EditarPro('+response[0].pk+');" class="btn"><img src="http://192.168.1.10/static/base/img/edit-9-24.ico" /></a></td><td><a href="#" onclick="javascript:ajax.EliminarPro('+_id_Proyecto+');" class="btn btn-danger"><img src="http://192.168.1.10/static/base/img/trash-can-16-24.ico" /></a></td>');
                $("#"+_id_Proyecto).addClass('success');
              },
        });
    }
    if (_accion=="TerminarAct") {
       $.ajax({
          async:true,
              url: '/GetDataActividadJson/'+_id_Actividad,
              type: 'POST',
              success: function(response) {
                status="";
                if (response[0].fields.Estatus) {
                  status='<img src="http://192.168.1.10/static/base/img/check-mark-3-24.ico">';
                  console.log(status);
                }else{
                  status='<img src="http://192.168.1.10/static/base/img/x-mark-24.ico">';
                  console.log(status);
                }
                $("#"+_id_Actividad).html('<td>'+response[0].fields.Actividad+'</td><td>'+response[0].fields.Proyecto+'</td><td>'+response[0].fields.Desde+'</td><td>'+response[0].fields.Hasta+'</td><td>'+status+'</td><td><a href="#" onclick="javascript:ajax.ShowDetail('+response[0].pk+');"><img src="http://192.168.1.10/static/base/img/book-16-32.ico"></a><div id="Detalles'+response[0].pk+'" style="display:none;"><b>Quien labora esta actividad :</b>'+response[0].fields.Usuario+'<br><b>Fecha de Solicitud: </b>'+response[0].fields.FechaSolicitud+'<br><b>Solicitud: </b>'+response[0].fields.Solicitud+'<br><b>Observacion: </b>'+response[0].fields.Observaciones+'</div></td><td><td><td><a href="/Avances/'+response[0].pk+'" title="Mostrar Actividades" ><img src="http://192.168.1.10/static/base/img/fullscreen-8-32.ico" /></a></td><td><a href="#" onclick="javascript:ajax.EditarActividad('+response[0].pk+');" class="btn"><img src="http://192.168.1.10/static/base/img/edit-9-24.ico" /></a></td>');
                $("#"+_id_Actividad).addClass('success');
              },
        });
    }

     if (_accion=="AgregarAvance") {
      var actividad=$("#actividad").text();
       $.ajax({
          async:true,
              url: '/GetDataAvanceJsonLast/',
              type: 'POST',
              success: function(response) {
                status="";
                if (response[0].fields.Estatus) {
                  status='<img src="http://192.168.1.10/static/base/img/check-mark-3-24.ico">';
                  console.log(status);
                }else{
                  status='<img src="http://192.168.1.10/static/base/img/x-mark-24.ico">';
                  console.log(status);
                }
                $("#avance").prepend('<tr id="'+response[0].pk+'"><td>'+response[0].fields.Avance+'</td><td>'+response[0].fields.Fecha+'</td><td>'+actividad+'</td><td>'+status+'</td><td><div class="progress progress-striped active"><div class="bar" style="width: '+response[0].fields.Points+'%;">'+response[0].fields.Points+'%</div></div></td></tr>');
                $("#avance tr td:last").text('');
                $("#avance tr:first").addClass('success');
              },
        });
    }
  }     
  function EliminarProAjax(id_Proyecto){
    eliminar=confirm("¿Deseas Eliminar este Proyecto?");
      if (eliminar){
        //Redireccionamos si das a acepta
         $.ajax({
            async:true,
                url: 'eliminarAjax/'+id_Proyecto,
                type: 'POST',
                success: function(response) {
                  if (response.exito) {
                    $("#"+id_Proyecto).remove();
                  }
                },
          });
     }
      else{
         //Y aquí pon cualquier cosa que quieras que salga si le diste al boton de cancelar
          alert('No se ha podido Eliminar este Proyecto...');
      }
  }

  function _AgregarActividadAjax(){
      _id_Proyecto = location.href.substr(location.href.lastIndexOf('/')+1);
      console.log(_id_Proyecto);
      var spinner = $( "#id_Points" ).spinner();
      $( "#id_Desde" ).datepicker({
        changeMonth: true,
        numberOfMonths: 2,
        dateFormat: 'yy-mm-dd',
        onClose: function( selectedDate ) {
          $( "#id_Hasta" ).datepicker( "option", "minDate", selectedDate );
          $( "#id_FechaSolicitud" ).datepicker( "option", "minDate", selectedDate );
        }
      });
      $( "#id_Hasta" ).datepicker({
        changeMonth: true,
        numberOfMonths: 2,
        dateFormat: 'yy-mm-dd',
        onClose: function( selectedDate ) {
          $( "#id_Desde" ).datepicker( "option", "maxDate", selectedDate );
        }
      });
      $("#id_FechaSolicitud").datepicker({
        changeMonth: true,
        numberOfMonths: 2,
        dateFormat: 'yy-mm-dd',
      });
      $('#exito').attr({'title':'Proyectos','href':'/Actividades/'+_id_Proyecto});
      $('#formulario').bind('submit', function(e) {
            e.preventDefault();
            var url = '/NuevaActividadAjax/';
            var fd = new FormData($('#formulario').get(0));
            fd.append("Proyecto", _id_Proyecto );
            fd.append("Estatus", 'on' );
            $.ajax({
              url: url,
              data: fd,
              type: 'POST',
              beforeSend: function(){
                   console.log("se enviaron datos");
                   console.log(fd);
              },
              success: function(data) {
                if (data.exito) {
                  $("#resultados").html("<span class='alert alert-success'>Creado Exitosamente</span>");
                  setTimeout(function(){ $("#resultados").html('')}, 2000);
                  if (_accion == 'AgregarAct') {
                    $("#formulario").get(0).reset();
                  };
                } else {
                   $("#resultados").html('');
                    if (data.errores.Actividad) {
                      $('<span class="alert alert-error"><b>Actividad </b>' + data.errores.Actividad + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Desde) {
                      $('<span class="alert alert-error"><b>Desde </b>' + data.errores.Desde + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Hasta) {
                      $('<span class="alert alert-error"><b>Hasta </b>' + data.errores.Hasta + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Proyecto) {
                      $('<span class="alert alert-error"><b>Proyecto </b>' + data.errores.Proyecto + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Usuario) {
                      $('<span class="alert alert-error"><b>Usuario </b>' + data.errores.Usuario + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Estatus) {
                      $('<span class="alert alert-error"><b>Estatus </b>' + data.errores.Estatus + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.FechaSolicitud) {
                      $('<span class="alert alert-error"><b>FechaSolicitud </b>' + data.errores.FechaSolicitud + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Solicitud) {
                      $('<span class="alert alert-error"><b>Solicitud </b>' + data.errores.Solicitud + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Observaciones) {
                      $('<span class="alert alert-error"><b>Observaciones </b>' + data.errores.Observaciones + '</span>').appendTo('#resultados');
                    }
                  
                }
              },
              processData: false,
              contentType: false
            });
      });
  }
  function EditarAct(){
    _id_Proyecto = location.href.substr(location.href.lastIndexOf('/')+1);
    _id_Actividad=$("#idActividad").text();
    $( "#id_Desde" ).datepicker({
        defaultDate: "+1w",
        changeMonth: true,
        numberOfMonths: 2,
        dateFormat: 'yy-mm-dd',
        onClose: function( selectedDate ) {
          $( "#id_Hasta" ).datepicker( "option", "minDate", selectedDate );
          $( "#id_FechaSolicitud" ).datepicker( "option", "minDate", selectedDate );
        }
      });
      $( "#id_Hasta" ).datepicker({
        defaultDate: "+1w",
        changeMonth: true,
        numberOfMonths: 3,
        dateFormat: 'yy-mm-dd',
        onClose: function( selectedDate ) {
          $( "#id_Desde" ).datepicker( "option", "maxDate", selectedDate );
        }
      });
      $("#id_FechaSolicitud").datepicker({
        defaultDate: "+1w",
        changeMonth: true,
        numberOfMonths: 2,
        dateFormat: 'yy-mm-dd',
      });
      $('#exito').attr({'title':'Actividades','href':'/Actividades/'+id_Actividad});
    $('#formulario').submit(_EditarActAjax);
  }
  function _EditarActAjax(e){
    e.preventDefault();
    var url = '/EditarActAjax/'+_id_Actividad;
          var fd = $(this).serialize();
          $.ajax({
                url: url,
                data: fd+'&Proyecto='+_id_Proyecto+'&Estatus=on',
                type: 'POST',
                beforeSend: function(){
                  console.log(fd);   
                },
                success: function(data) {
                  if (data.exito) {
                      $("#resultados").html("<span class='alert alert-success'>Creado Exitosamente</span>");
                      setTimeout(function(){ $("#resultados").html('')}, 2000);
                  } else {
                    $("#resultados").html('');
                    if (data.errores.Actividad) {
                      $('<span class="alert alert-error"><b>Actividad </b>' + data.errores.Actividad + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Desde) {
                      $('<span class="alert alert-error"><b>Desde </b>' + data.errores.Desde + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Hasta) {
                      $('<span class="alert alert-error"><b>Hasta </b>' + data.errores.Hasta + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Proyecto) {
                      $('<span class="alert alert-error"><b>Proyecto </b>' + data.errores.Proyecto + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Usuario) {
                      $('<span class="alert alert-error"><b>Usuario </b>' + data.errores.Usuario + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Estatus) {
                      $('<span class="alert alert-error"><b>Estatus </b>' + data.errores.Estatus + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.FechaSolicitud) {
                      $('<span class="alert alert-error"><b>FechaSolicitud </b>' + data.errores.FechaSolicitud + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Solicitud) {
                      $('<span class="alert alert-error"><b>Solicitud </b>' + data.errores.Solicitud + '</span>').appendTo('#resultados');
                    }
                    if (data.errores.Observaciones) {
                      $('<span class="alert alert-error"><b>Observaciones </b>' + data.errores.Observaciones + '</span>').appendTo('#resultados');
                    }
                  }
                },  
          });
  } 
  function ViewDetailAct(id){
    $("#Detalles"+id).dialog({
                modal: true,
                width: 600,
                title:'Detalles',
                minWidth: 300,
                maxWidth: 300,
                position: 'center',
                //height:600,
                show: "fold",
                hide: "slow",
                resizable: false,
    });
  }

  function finalizarActAjax(id){
     eliminar=confirm("¿Deseas Terminar esta Actividad?");
      if (eliminar){
        //Redireccionamos si das a acepta
        $.ajax({
          async:true,
              url: '/finalizarActAjax/'+id,
              type: 'POST',
              success: function(response) {
                if (response.exito) {
                  $("#"+id).remove();
                }
              },
        });
     }
      else{
         //Y aquí pon cualquier cosa que quieras que salga si le diste al boton de cancelar
          alert('No se ha podido Terminar esta Actividad...');
      }
  }
  function SendInbox(idActividad,Envio,Usuario){
    console.log(idActividad+" "+Envio+" "+Usuario);
    $('#inbox').modal('show');
    $('#mensaje').bind('submit', function(e) {
            e.preventDefault();
            var url ='/Correo/';
            var fd = new FormData($('#formulario').get(0));
            fd.append("Usuario", Usuario );
            fd.append("Actividad", idActividad );
            fd.append("Envio", Envio );
            $.ajax({
                url: url,
                data: fd,
                type: 'POST',
               beforeSend: function(){
                     console.log(fd);
                },
                success: function(data) {
                  if (data.exito) {
                      $("#mensaje").get(0).reset();
                      $("#Exito").show();
                      $("#succes").html("su mensaje se envio Exitosamente");
                      setTimeout(function(){ $("#serult").html('');$(".alert").hide();}, 5000);
                      
                  } else {
                    $("#serult").html('');
                    $(".alert").show();
                    if (data.errores.Descripcion) {
                      $("#serult").html('No se ha insertado nada en el campo Error: '+data.errores.Descripcion);
                    }
                  }
                },
                processData: false,
                contentType: false
            });
    });
  }
    function EliminarActAjax(id_Actividad,actividad,id_Usuario){
      _id_Actividad=id_Actividad;
      _id_Usuario=id_Usuario;
      _actividad=actividad;
     $("#allformulario").dialog({
                modal: true,
                width: 910,
                minWidth: 300,
                title:'Borrar Actividad',
                maxWidth: 300,
                height:600,
                show: "fold",
                resizable: false,
      });
     $("#exito").hide();
      $('#formulario').bind('submit', function(e) {
        e.preventDefault();
        eliminar=confirm("¿Deseas Eliminar esta Actividad?");
         if (eliminar){
          var url = '/EliminarActAjax/'+_id_Actividad;
              var fd = $(this).serialize();
              var fd = new FormData($('#formulario').get(0));
              fd.append("actividad", _actividad );
              fd.append("Usuario", _id_Usuario );
              fd.append("Estatus", 'on' );
              $.ajax({
                url: url,
                data: fd,
                type: 'POST',
                beforeSend: function(){
                     console.log(fd.actividad);
                },
                success: function(data) {
                  if (data.exito) {
                    $("#"+_id_Actividad).remove();
                    $("#formulario").get(0).reset();
                    $("#allformulario").dialog('close');
                  } else {
                     $("#resultados").html('');
                      if (data.errores.motivo) {
                        $('<span class="alert alert-error"><b>motivo </b>' + data.errores.motivo + '</span>').appendTo('#resultados');
                      }
                      if (data.errores.Observacion) {
                        $('<span class="alert alert-error"><b>Observacion </b>' + data.errores.Observacion + '</span>').appendTo('#resultados');
                      }
                  }
                },
                processData: false,
                contentType: false
              });
          }
          else{
               //Y aquí pon cualquier cosa que quieras que salga si le diste al boton de cancelar
                alert('No se ha podido Eliminar esta Actividad...');
            }
       });
  }
  return{
    inicio:started,
    EditarPro: EditarProyecto,
    EliminarPro:EliminarProAjax,
    EditarActividad : EditarAct,
    EliminarAct: EliminarActAjax,
    ShowDetail: ViewDetailAct,
    mensaje : SendInbox,
    finalizarAct:finalizarActAjax
  }

})(jQuery);

$(document).on('ready', ajax.inicio );